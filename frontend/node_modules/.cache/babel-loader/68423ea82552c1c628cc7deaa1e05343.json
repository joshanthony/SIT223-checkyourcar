{"ast":null,"code":"var _jsxFileName = \"/Users/josh/Dropbox/Deakin/SIT223-Professional-Practice-In-IT/Group-Assignment/CheckYourCar/frontend/src/pages/Account.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { BrowserRouter as Router, Link, withRouter } from \"react-router-dom\";\nimport Cars from '../components/Cars/Cars';\nimport Spinner from '../components/Spinner/Spinner';\n\nclass Account extends Component {\n  constructor(props) {\n    super(props);\n\n    this.deleteResultHandler = (resultIndex, id) => {\n      const results = [...this.state.results];\n      results.splice(resultIndex, 1);\n      this.setState({\n        results: results\n      }); // TODO tell the server a result is deleted\n\n      axios.defaults.headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${localStorage.getItem('token')}`\n      };\n      axios.patch(`http://127.0.0.1:8000/api/cars/${id}/remove/`).then(res => {\n        console.log(res);\n      });\n    };\n\n    this.state = {\n      results: [],\n      showResults: false,\n      loading: true\n    };\n    this.deleteResultHandler = this.deleteResultHandler.bind(this);\n  }\n\n  componentDidMount() {\n    const results = [];\n    const token = localStorage.getItem('token');\n    axios.defaults.headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Token ${token}`\n    };\n    axios.get('http://127.0.0.1:8000/api/cars/').then(res => {\n      this.setState({\n        results: res.data\n      });\n      console.log(res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n    this.setState({\n      results: results,\n      showResults: true,\n      loading: false\n    });\n  }\n\n  render() {\n    if (!this.props.isAuthenticated) {\n      this.props.history.push('/login');\n    }\n\n    let results = null;\n\n    if (this.state.showResults && this.props.isAuthenticated) {\n      results = /*#__PURE__*/React.createElement(Cars, {\n        results: this.state.results,\n        clicked: this.deleteResultHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 23\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Home\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"page-title display-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 25\n      }\n    }, \"My Account\"))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"row justify-content-md-center mb-4 mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-primary\",\n      to: \"/add\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 25\n      }\n    }, \"Add New Car\"), \" \", /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-secondary\",\n      to: \"/settings\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 88\n      }\n    }, \"Account Settings\"))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"row justify-content-md-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 21\n      }\n    }, this.state.loading ? /*#__PURE__*/React.createElement(Spinner, {\n      text: \"Loading...\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 47\n      }\n    }) : results)));\n  }\n\n}\n\nexport default withRouter(Account);","map":{"version":3,"sources":["/Users/josh/Dropbox/Deakin/SIT223-Professional-Practice-In-IT/Group-Assignment/CheckYourCar/frontend/src/pages/Account.js"],"names":["React","Component","axios","BrowserRouter","Router","Link","withRouter","Cars","Spinner","Account","constructor","props","deleteResultHandler","resultIndex","id","results","state","splice","setState","defaults","headers","Authorization","localStorage","getItem","patch","then","res","console","log","showResults","loading","bind","componentDidMount","token","get","data","catch","err","render","isAuthenticated","history","push"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,aAAa,IAAIC,MAA1B,EAAkCC,IAAlC,EAAwCC,UAAxC,QAA0D,kBAA1D;AACA,OAAOC,IAAP,MAAiB,yBAAjB;AACA,OAAOC,OAAP,MAAoB,+BAApB;;AAEA,MAAMC,OAAN,SAAsBR,SAAtB,CAAgC;AAC5BS,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SAqCnBC,mBArCmB,GAqCG,CAACC,WAAD,EAAcC,EAAd,KAAqB;AACvC,YAAMC,OAAO,GAAG,CAAC,GAAG,KAAKC,KAAL,CAAWD,OAAf,CAAhB;AACAA,MAAAA,OAAO,CAACE,MAAR,CAAeJ,WAAf,EAA4B,CAA5B;AACA,WAAKK,QAAL,CAAc;AAACH,QAAAA,OAAO,EAAEA;AAAV,OAAd,EAHuC,CAKvC;;AACAb,MAAAA,KAAK,CAACiB,QAAN,CAAeC,OAAf,GAAyB;AACrB,wBAAgB,kBADK;AAErBC,QAAAA,aAAa,EAAG,SAAQC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8B;AAFjC,OAAzB;AAIArB,MAAAA,KAAK,CACAsB,KADL,CACY,kCAAiCV,EAAG,UADhD,EAEKW,IAFL,CAEUC,GAAG,IAAI;AACTC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,OAJL;AAMH,KArDkB;;AAEf,SAAKV,KAAL,GAAa;AACTD,MAAAA,OAAO,EAAE,EADA;AAETc,MAAAA,WAAW,EAAE,KAFJ;AAGTC,MAAAA,OAAO,EAAE;AAHA,KAAb;AAKA,SAAKlB,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBmB,IAAzB,CAA8B,IAA9B,CAA3B;AACH;;AAEDC,EAAAA,iBAAiB,GAAG;AAChB,UAAMjB,OAAO,GAAG,EAAhB;AAEA,UAAMkB,KAAK,GAAGX,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;AAEArB,IAAAA,KAAK,CAACiB,QAAN,CAAeC,OAAf,GAAyB;AACrB,sBAAgB,kBADK;AAErBC,MAAAA,aAAa,EAAG,SAAQY,KAAM;AAFT,KAAzB;AAKA/B,IAAAA,KAAK,CACAgC,GADL,CACS,iCADT,EAEKT,IAFL,CAEUC,GAAG,IAAI;AACT,WAAKR,QAAL,CAAc;AAAEH,QAAAA,OAAO,EAAEW,GAAG,CAACS;AAAf,OAAd;AACAR,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACS,IAAhB;AACH,KALL,EAMKC,KANL,CAMWC,GAAG,IAAI;AACVV,MAAAA,OAAO,CAACC,GAAR,CAAYS,GAAZ;AACH,KARL;AAUA,SAAKnB,QAAL,CAAc;AACVH,MAAAA,OAAO,EAAEA,OADC;AAEVc,MAAAA,WAAW,EAAE,IAFH;AAGVC,MAAAA,OAAO,EAAE;AAHC,KAAd;AAKH;;AAoBDQ,EAAAA,MAAM,GAAG;AACL,QAAG,CAAC,KAAK3B,KAAL,CAAW4B,eAAf,EAAgC;AAC5B,WAAK5B,KAAL,CAAW6B,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB;AACH;;AACD,QAAI1B,OAAO,GAAG,IAAd;;AAEA,QAAG,KAAKC,KAAL,CAAWa,WAAX,IAA0B,KAAKlB,KAAL,CAAW4B,eAAxC,EAAyD;AACrDxB,MAAAA,OAAO,gBAAG,oBAAC,IAAD;AACN,QAAA,OAAO,EAAE,KAAKC,KAAL,CAAWD,OADd;AAEN,QAAA,OAAO,EAAE,KAAKH,mBAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAV;AAGH;;AACD,wBACI;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAI,MAAA,SAAS,EAAC,sBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,CADJ,CADJ,eAMI;AAAK,MAAA,KAAK,EAAC,yCAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,OAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,iBAAhB;AAAkC,MAAA,EAAE,EAAC,MAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADJ,oBACmE,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,mBAAhB;AAAoC,MAAA,EAAE,EAAC,WAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADnE,CADJ,CANJ,eAWI;AAAK,MAAA,KAAK,EAAC,+BAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAC,OAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKI,KAAL,CAAWc,OAAX,gBAAqB,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAC,YAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAArB,GAAqDf,OAD1D,CADJ,CAXJ,CADJ;AAmBH;;AAtF2B;;AAyFhC,eAAeT,UAAU,CAACG,OAAD,CAAzB","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport { BrowserRouter as Router, Link, withRouter } from \"react-router-dom\";\nimport Cars from '../components/Cars/Cars';\nimport Spinner from '../components/Spinner/Spinner';\n\nclass Account extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            results: [],\n            showResults: false,\n            loading: true\n        };\n        this.deleteResultHandler = this.deleteResultHandler.bind(this);\n    }\n\n    componentDidMount() {\n        const results = []\n\n        const token = localStorage.getItem('token');\n\n        axios.defaults.headers = {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Token ${token}`\n        };\n\n        axios\n            .get('http://127.0.0.1:8000/api/cars/')\n            .then(res => {\n                this.setState({ results: res.data });\n                console.log(res.data);\n            })\n            .catch(err => {\n                console.log(err);\n            });\n\n        this.setState({\n            results: results,\n            showResults: true,\n            loading: false\n        });\n    }\n\n    deleteResultHandler = (resultIndex, id) => {\n        const results = [...this.state.results];\n        results.splice(resultIndex, 1);\n        this.setState({results: results});\n\n        // TODO tell the server a result is deleted\n        axios.defaults.headers = {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Token ${localStorage.getItem('token')}`\n        };\n        axios\n            .patch(`http://127.0.0.1:8000/api/cars/${id}/remove/`)\n            .then(res => {\n                console.log(res);\n            })\n\n    }\n\n    render() {\n        if(!this.props.isAuthenticated) {\n            this.props.history.push('/login');\n        }\n        let results = null;\n\n        if(this.state.showResults && this.props.isAuthenticated) {\n            results = <Cars\n                results={this.state.results}\n                clicked={this.deleteResultHandler} />\n        }\n        return (\n            <div className=\"Home\">\n                <div class=\"row\">\n                    <div class=\"col\">\n                        <h1 className=\"page-title display-4\">My Account</h1>\n                    </div>\n                </div>\n                <div class=\"row justify-content-md-center mb-4 mt-4\">\n                    <div class=\"col-4\">\n                        <Link className=\"btn btn-primary\" to=\"/add\">Add New Car</Link> <Link className=\"btn btn-secondary\" to=\"/settings\">Account Settings</Link>\n                    </div>\n                </div>\n                <div class=\"row justify-content-md-center\">\n                    <div class=\"col-6\">\n                        {this.state.loading ? <Spinner text=\"Loading...\" /> : results}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(Account);"]},"metadata":{},"sourceType":"module"}